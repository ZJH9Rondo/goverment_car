<template>
    <div class="wrapper">
        <embed class="content" :style="{visibility: item.visibility}" v-for="(item,i) in tabItems" :key="i" :src="item.src" type="weex"></embed>
        <div class="tabbar" append="tree">
          <wxc-tabitem v-for="item in tabItems" :key="item.index" :index="item.index" :icon="item.icon" :title="item.title" :title-color="item.titleColor"></wxc-tabitem>
        </div>
    </div>
</template>

<style scoped="">
    .wrapper { 
        width: 750; 
        position: absolute; 
        top: 0; 
        left: 0; 
        right: 0; 
        bottom: 0;
    }
    .content { 
        position: absolute; 
        top: 0;
        left: 0; 
        right: 0; 
        bottom: 0; 
        margin-top: 0;  
        margin-bottom: 100;
    }
    .tabbar { 
        flex-direction: row; 
        position: fixed; 
        bottom: 0; 
        left: 0; 
        right: 0;  
        height: 100;
    }
</style>

<script>
import WxcTabitem from 'weex-components/src/wxc-tabitem.vue'

export default {
  components: {WxcTabitem},
  data() {
      return {
        selectedIndex: 0
      }
  },
  props: {
    tabItems: { default: [] },
    selectedColor: { default: '#ff0000' },
    unselectedColor: { default: '#000000' }
  },
  created: function () {
    this.select(this.selectedIndex);
    this.$on('tabBar.Onclick',function (e){
       this.selectedIndex = e.index;
       this.select(e.index);
       this.$emit('tabBar.OnClick', e);
    })
  },
  methods: {
    //  tabItemOnClick: function(e) {
    //     this.selectedIndex = e.index;
    //     this.select(e.index);
    //     this.$emit('tabBarOnClick', e);
    //   },
    select: function (index) {
      for (var i = 0; i < this.tabItems.length; i++) {
        var tabItem = this.tabItems[i];
        if (i == index) {
          tabItem.icon = tabItem.selectedImage;
          tabItem.titleColor = this.selectedColor;
          tabItem.visibility = 'visible';
        } else {
          tabItem.icon = tabItem.image;
          tabItem.titleColor = this.unselectedColor;
          tabItem.visibility = 'hidden';
        }
      }
    }
  }
};</script>